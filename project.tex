%%% Local Variables: 
%%% mode: pdflatex
%%% TeX-master: t
%%% End: 

\documentclass[onecolumn,x11names,technote,twoside,a4paper,10pt,english]{IEEEtran}
\usepackage[english]{babel}
\usepackage[pdftex]{graphicx}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{caption}
\usepackage{float}
\usepackage{tikz}
\usepackage{euler}                                %Nicer numbers


\begin{document}

\title{Project in Digital Communication Systems}
\author{Noam Lewis, Zvulun Avramov}

\maketitle

\section{Answers to Preparatory Questions}

We have selected modulation number 5, entailing digital input data, $R_b=800$, QAM, and $B_{ch}=800Hz$. Because $R_s=\frac{R_b}{log_2M}$, and the required bandwidth is $B_{min}=2R_s=800Hz$, we can calculate $M$:
\begin{eqnarray*}
  log_2M &=& \frac{R_b}{R_s} \\
  &=& \frac{2R_b}{B_{min}} \\
  &=& \frac{1600}{800} = 2
\end{eqnarray*}
Therefore, $M=4$ so we are using 4QAM. Choosing symmetric symbols yields $A_n \in \{\pm \sqrt{1/2} \pm j \sqrt{1/2} \}$ with $|A_n|=1$ and $\phi_n \in \{ \pi/4, 3\pi/4, 5\pi/4, 7\pi/4 \}$. 

\begin{enumerate}
\item The modulated message $s_M(t)$ is:
  \begin{eqnarray*}
    \label{eq:s_M}
    s_M(t) &=& Re\{s_d(t)\sqrt{2P_c}e^{j\omega_c t}\} \\
           &=& \sqrt{2P_c}\sum_n{|A_n| g(t-n T_s) cos(\omega_ct + \phi_n)} \\
           &=& \sqrt{2P_c}\sum_n{ |A_n| cos(\phi_n) g(t-n T_s) cos(\omega_ct) - |A_n| sin(\phi_n) g(t-n T_s) sin(\omega_ct)} \\
           &=& \sqrt{2P_c}\sum_n{ A_{n_i} g(t-n T_s) cos(\omega_ct) - A_{n_q} g(t-n T_s) sin(\omega_ct)}
  \end{eqnarray*}
  Where  $A_n=A_{n_i}+jA_{n_q}=|A_n|e^{j\phi_n}=e^{j\phi_n}$.
  In the case of $t \in K T_s$, where $K \in \mathbb{Z}$, we can use the fact that $\forall t \notin n T_s : g(t-n T_s)=0$, and $1$ otherwise to arrive at:
  \begin{eqnarray*}
    s_M(t \in K T_s) &=& \sqrt{2P_c} cos(\omega_c t + \phi_K) \\
                     &=& \sqrt{2P_c} \left[ cos(\phi_K)cos(\omega_c t) - sin(\phi_K)sin(\omega_c t) \right] \\
                     &=& \sqrt{2P_c} \left[ A_{K_i}cos(\omega_c t) - A_{K_q}sin(\omega_c t) \right] 
  \end{eqnarray*}
\item Using known results from DSB modulation, and because we have a full response filter, and assuming that the symbols have expectation $0$:
  \begin{eqnarray*}
    S_M(f) &=& \frac{P_c}{2}(S_d(f-f_c)+S_d(f+f_c)) \\
    G(f)   &=& T_s sinc(\pi f T_s)e^{-j\pi f T_s} \\
    |G(f)|^2 &=& T_s^2 sinc^2(\pi f T_s)        \\
    S_d(f) &=& \frac{\sigma_a^2}{T_s} |G(f)|^2 =  T_s\sigma_a^2 sinc^2(\pi f T_s) \\
    \sigma_a^2 &=& \sum_{k=1}^M{p_k A_k^2} = \frac{1}{4} 4 = 1
  \end{eqnarray*}
  Substituting $S_d$ into $S_m$ we get:
  \begin{equation}
    \label{eq:S_M(f)}
    S_M(f) = \frac{P_c}{2R_s}\left[ sinc^2(\pi T_s(f-f_c)) + sinc^2(\pi T_s(f+f_c)) \right]
  \end{equation}
  The graph of $S_M(f)$ with example parameters is show in Figure \ref{fig:S_M(f)}.
  \begin{figure}[h!]
    \centering
    \input{q2.latex}
    \caption{$S_M(f)$ for $R_s=T_s^{-1}=10,f_c=100$}
    \label{fig:S_M(f)}
  \end{figure}
  When there is no noise in the channel, and with ideal synchronization the demodulated signal is:
    \begin{eqnarray*}
      x_{d_i}(t) &=& x(t)A_0 cos(\omega_c t) \\
                &=& A_0\sqrt{2P_r} cos(\omega_c t + \phi_K) cos(\omega_c t) \\
                &=& A_0\sqrt{\frac{P_r}{2}} \left[ cos(\phi_k) + cos(2\omega_c t + \phi) \right] \\
      x_{d_q}(t) &=& -x(t)A_0 sin(\omega_c t) \\
                &=& A_0\sqrt{\frac{P_r}{2}} \left[ sin(\phi_k) + sin(2\omega_c t + \phi) \right] 
    \end{eqnarray*}
  If $x_{d_i}(t)$ for example passes through the appropriate matched filter, the output is:
  \begin{eqnarray*}
    a_{k_i} &=& \int_{kT_s}^{(k+1)T_s}{ x_{d_i}(t) g(t-kT_s) dt} \\
           &=&  \int_{kT_s}^{(k+1)T_s}{ A_0\sqrt{\frac{P_r}{2}} \left[ cos(\phi_k) + cos(2\omega_c t + \phi) \right]  dt} \\
           &=&  A_0\sqrt{\frac{P_r}{2}} T_s cos(\phi_k) \int_{kT_s}^{(k+1)T_s}{ cos(2\omega_c t + \phi)  dt} 
  \end{eqnarray*}
  If $R_s \to m (2f_c)$ where $m \in \mathbb{N}$, the integral goes to zero, and we are left with:
  \begin{eqnarray*}
    a_{k_i} &=& A_0\sqrt{\frac{P_r}{2}} T_s cos(\phi_k) = \frac{\sqrt{P_r} A_{k_i}}{R_s} \\
    a_{k_q} &=& A_0\sqrt{\frac{P_r}{2}} T_s sin(\phi_k) = \frac{\sqrt{P_r} A_{k_q}}{R_s}
  \end{eqnarray*}
  Where the right hand sides result from choosing $A_0=\sqrt{2}$. Combining the components gives:
  \begin{equation}
    \label{eq:a_k}
    a_k = a_{k_i} + j a_{k_q} = \frac{\sqrt{P_r}}{R_s} A_k
  \end{equation}

\item For a symbol dictionary of size $M$: $R_s=\frac{R_b}{log_2M}$ and $K_b=log_2M$.

\item In Gray coding, every two consequetive numbers differ by exactly one bit. The encoding reduces BER by assigning similar codes to closer symbols. The probability of receiving a symbol in close vicinity to the transmitted one is higher, so errors with small number of bit flips are more probable. In our case (where $M=4$) we can assign:

  \begin{center}
    \begin{table}[h!]
      \centering
      \begin{tabular}[h!]{| l | l | l |}
      \hline
      Code & Symbol & \\ \hline
      $00$ & $+\sqrt{1/2}+j\sqrt{1/2}$ & $A_1$  \\ \hline
      $01$ & $-\sqrt{1/2}+j\sqrt{1/2}$ & $A_2$  \\ \hline
      $11$ & $-\sqrt{1/2}-j\sqrt{1/2}$ & $A_3$  \\ \hline
      $10$ & $+\sqrt{1/2}-j\sqrt{1/2}$ & $A_4$  \\
      \hline
      \end{tabular}
      \caption{Assignment of bit patterns to symbols}
      \label{tab:bitsymbols}
    \end{table}
  \end{center}

\item The symbol constellation is shown in Figure \ref{fig:4qam-const}. 
  \begin{figure}[h!]
    \begin{center}
      \begin{tikzpicture}[scale=3]
        % Circles 
        \foreach \r in { 1}
        \draw[Azure4, thin] (0,0) circle (\r);
        % 45° Rays
        \foreach \a in {0, 45,...,359}
        \draw[Azure4] (\a:1) -- (\a:1.5);
        % Radius labels (background filled white)
        \draw (0.707,0) node[inner sep=1pt,below=3pt,rectangle,fill=white] {$\frac{1}{\sqrt{2}}$};
        \draw (0,0.707) node[inner sep=1pt,left=3pt,rectangle,fill=white] {$j\frac{1}{\sqrt{2}}$};
        \draw (-0.707,0) node[inner sep=1pt,below=3pt,rectangle,fill=white] {$-\frac{1}{\sqrt{2}}$};
        \draw (0,-0.707) node[inner sep=1pt,left=3pt,rectangle,fill=white] {$-j\frac{1}{\sqrt{2}}$};
        % Main rays
        \foreach \a in {0, 90,...,359}
        \draw[very thick] (0, 0) -- (\a:1.5);
        % Angle labels  
        \foreach \a in {0, 45,...,359}
        \draw (\a: 1.6) node {$\a^\circ$};
        % Central point
        \draw[fill=red] (0.707,0.707) circle(0.4mm) node[inner sep=1pt,below=4pt,rectangle] {$00$};
        \draw[fill=red] (-0.707,0.707) circle(0.4mm)  node[inner sep=1pt,below=4pt,rectangle] {$01$};
        \draw[fill=red] (-0.707,-0.707) circle(0.4mm)  node[inner sep=1pt,below=4pt,rectangle] {$11$};
        \draw[fill=red] (0.707,-0.707) circle(0.4mm)  node[inner sep=1pt,below=4pt,rectangle] {$10$};
      \end{tikzpicture}
    \end{center}
    \caption{Constellation of symbols. Each node is labeled with the assigned (gray coded) bit pattern.}
    \label{fig:4qam-const}
  \end{figure}

\item The Euclidean distance between adjacent symbols is $\frac{2}{\sqrt{2}}=\sqrt{2}$. In terms of phase drift, the distance is $\pi/4$.

\item Effects of channel on the communication system:
  \begin{enumerate}
  \item AWGN - The noise appears as an additive element in the symbols entering the decision device. If $a_k$ is the portion originating from the source signal, and $z_k$ is the effect of the noise, then $q_k = a_k + z_k$. For a time period where $t \in k T_s$ we have:
    \begin{eqnarray*}
      x(t) &=& s_r(t) + n_r(t) \\
      s_r(t) &=& k_{ch}s_M(t) = \sqrt{2P_r} \left[ cos(\phi_K)cos(\omega_c t) - sin(\phi_K)sin(\omega_c t) \right]  \\
      n_r(t) &=& n_{r_i}(t)cos(\omega_c t) - n_{r_q}(t) sin(\omega_c t) \\
    \end{eqnarray*}
    The noise component affects $\text{SNR}_d$. The relevant parameter is the noise power (variance) $\sigma_z^2$.

  \item Limited channel bandwidth - ISI (Inter Symbol Intereference): In this case the received symbol $q_k$ has an additional component, the ISI: $q_k = p_0A_K + \sum_{n \neq k} {A_n p_{k-n}} + z_k$. This effect can be countered by, for example, an optimal sequential detector.

  \item Phase and Frequency shift - after demodulation (separately for the two bases), we get:
    \begin{eqnarray*}
      x_{d_i}(t) &=& x(t)A_c cos(\omega_c t) \\
                &=& A_c\sqrt{2P_r} cos(\omega_r t + \phi_K + \Psi) cos(\omega_c t) + A_c cos(\omega_c t) n_r(t)\\
                &=& A_c\sqrt{\frac{P_r}{2}} cos(\phi_k + \Psi + \Delta \omega t) 
                    + \underbrace{ \frac{A_c}{2} \left( n_{r_i}(t) + n_{r_q}(t) \right) }_{\mbox{additive noise component}} 
                    + \text{ Higher frequency components} \\
      x_{d_q}(t) &=& -x(t)A_c sin(\omega_c t) = A_c\sqrt{\frac{P_r}{2}} sin(\phi_k + \Delta \omega t + \Psi) + \text{ ... }
    \end{eqnarray*}
    Where $\Delta \omega = \omega_r - \omega_c$ is the frequency shift, and $\Psi$ is the phase shift. Since we are using 4-QAM, if the phase shift nears $\pi/8$ the symbols may be confused, so a phase synchronizer is required.
    
  \end{enumerate}

  \item Definitions of $\text{SNR}_{bit}^{(DD)}$ and $\text{SNR}_{sym}^{(DD)}$: 
    
\item $erfc(\lambda) = 2Q( \sqrt{2}\lambda )$.

\item Because we are using code gray, the following relation holds whenever the SNR is high enough to make transitions to far symbols unlikely:
    \begin{equation*}
      P_{err,bit}^{(DD)} \approx \frac{P_{err,sym}^{(DD)}}{log_2{M}} = \frac{P_{err,sym}^{(DD)}}{2}
    \end{equation*}
    The probability for symbol error is defined by:
    \begin{equation*}
      P_{err,sym}^{(DD)} = \sum_{m=1}^M {p_m P(\text{error} | A_m)} = \sum_{m=1}^M {p_m \left[ 1 - \prod_{n=1,n \neq m}^M \left( 1 - P(A_n | A_m) \right) \right]} 
    \end{equation*}
    Where, if $d_{m,n}= |A_m - A_n|$ is the Euclidean distance between symbols $A_m$ and $A_n$:
    \begin{equation*}
      P(A_n | A_m) = Q\left( \frac{d_{m,n}}{2 \sigma_z}\right)
    \end{equation*}
    In our case, $d_{m,n} = \sqrt{2}$ for neighboring symbols, and $d_{m,n} = 2$ for the non-neighboring ones. Due to the nature of the $Q$ function we can safely discard the terms for the probabilities between non-neighboring symbols.

    We want the probability expressed as a function of $\gamma_d$:
    \begin{equation*}
      \gamma_d = \frac{E_r}{N_0}
    \end{equation*}
    We can calculate $E_r$ as follows:
    \begin{eqnarray*}
      E_r &=& \int_0^{T_s}{s^2_r(t) dt} \\
          &=& 2P_r \int_0^{T_s}{ \left[ A_{K_i}cos(\omega_c t) - A_{K_q}sin(\omega_c t) \right]^2 dt} \\
          &=& 2P_r \int_0^{T_s}{ \left[ A_{K_i}^2cos^2(\omega_c t) + A_{K_q}^2sin^2(\omega_c t) - \frac{1}{2} A_{K_i} A_{K_q} sin(2\omega_c t) \right] dt} \\
          && \{\text{Discarding higher-frequency components which would be filtered in the integration}\} \\
          &=& P_r \int_0^{T_s}{ \left[ A_{K_i}^2 + A_{K_q}^2 \right] dt} \\
          &=& \frac{P_r |A_{K}|^2}{R_s} = \frac{P_r}{R_s}
    \end{eqnarray*}
    Therefore,
    \begin{equation*}
      \gamma_d = \frac{P_r}{R_s N_0}
    \end{equation*}
    Using Equation \ref{eq:a_k} from question 2, we can express the distance between nearby symbols as:
    \begin{equation*}
      d_{m,n} = | \frac{\sqrt{P_r}}{R_s} (A_m - A_n) | = \frac{\sqrt{P_r}}{R_s} |A_m - A_n|
    \end{equation*}
    In our case for neighboring symbols $|A_m - A_n|=\sqrt{2}$ so:
    \begin{equation*}
      d_{m,n} = \frac{\sqrt{2P_r}}{R_s}
    \end{equation*}
    To find $\sigma_z$ we calculate the noise component output from the matched filter:
    \begin{eqnarray*}
      z_k &=& \int_{kT_s}^{(k+1)T_s}{ n_r(t) A_0 cos(\omega_c t) g(t-kT_s) dt} \\
          && \{\text{Discarding higher-frequency components}\} \\
          &=& \frac{A_0}{2} \int_{kT_s}^{(k+1)T_s}{ n_{r_i}(t) dt} 
    \end{eqnarray*}
    Assuming Gaussian white noise, because the integral (the matched filter) is a linear system we can calculate the variance (the power) as:
    \begin{eqnarray*} 
      \sigma_z^2 &=& \int_{-\infty}^{\infty}{ S_{n_i}(f) |H_{MF}(f)|^2 df} \\
                 &=& \int_{-\infty}^{\infty}{ \frac{N_0}{2}  |H_{MF}(f)|^2 df} \\
                 &=& \frac{N_0}{2} \int_{-\infty}^{\infty}{  |H_{MF}(f)|^2 df} \\
                 && \{\text{Parseval's theorem}\} \\
                 &=& \frac{N_0}{2} E_g
    \end{eqnarray*}

    Thus,
    \begin{equation*}
      \frac{d_{m,n}}{2\sigma_z} = \frac{\sqrt{2P_r}}{R_s} \frac{1}{2 \sqrt{\frac{N_0}{2} E_g} } = \frac{\sqrt{P_r}}{R_s} \frac{1}{\sqrt{N_0 T_s} } = \frac{\sqrt{P_rR_s}}{R_s\sqrt{N_0 }} = \sqrt{\frac{P_r}{R_s N_0 }} = \sqrt{\gamma_d}
    \end{equation*}
    Finally,
    \begin{eqnarray*}
      P(A_n | A_m) &=& Q\left( \sqrt{\gamma_d}\right) \nonumber \\
      P_{err,sym}^{(DD)} &=& \sum_{m=1}^4 {p_m \left[ 1 - \prod_{n=1,n \neq m}^4 \left( 1 - Q\left( \sqrt{\gamma_d}\right) \right) \right]}
    \end{eqnarray*}
    Discarding higher-order Q's (including the ones for the non-neighboring symbols), and also assuming uniform symbol distribution ($p_m=1/4$), we arrive at:
    \begin{equation}
      \label{eq:P_errsym}
      P_{err,sym}^{(DD)} = 2Q\left( \sqrt{\gamma_d}\right) 
    \end{equation}
 
\end{enumerate}

\section{Simulation}

\subsection{Data sets}
\begin{enumerate}
\item Small data set - the bit sequence: $\{0,0,1,1,1,0,0,1\}$, which corresponds to the sequence $\{A_1, A_3, A_4, A_2\}$.
\item Large (random) data set - a random stream of $5^3 log_2M = 10^3$ bits. The data set was created by applying the function $f(x) = \text{\bf{ if }} x>0.5 \text{\bf{ then }} 1 \text{\bf{ else }} 0$ to each element of a vector constructed with the Matlab 'rand' function.
\end{enumerate}

\subsection{Transmitter}
The chosen sampling frequency was $8 f_c$, so that:
\begin{itemize}
\item Nyquist's criterion is met ($2 f_c$ would suffice)
\item Enough samples are shown in the Matlab graphs, to make the real amplitude visible.
\end{itemize}

The symbol/bit patterns appear in Table \ref{tab:bitsymbols}. The symbol constellation is shown in Figure \ref{fig:trans_constellation}.

\begin{enumerate}
\item $P_c = 10W$, therefore $A_c = \sqrt{20}$.
\item $f_c = 20kHz$ so $w_c = 4\pi \cdot 10^4$.
\item Sampling frequency (for simulation of the continuous signal) is $f_s = 2f_c = 40khz$.
\end{enumerate}

  \begin{figure}[h!]
    \centering
    \includegraphics[height=4in]{symbol_constellation.png}
    \caption{Constellation of symbols received}
    \label{fig:trans_constellation}
  \end{figure}

The time response of the small dataset is shown in Figure \ref{fig:s_M(t)}. The frequency response of the large (random) data set is show in Figure \ref{fig:S_M(f)}.

  \begin{figure}[h!]
    \centering
    \includegraphics[height=4in]{modulated_small_dataset.png}
    \caption{$s_M(t)$ for small data set}
    \label{fig:s_M(t)}
  \end{figure}

  \begin{figure}[h!]
    \centering
    \includegraphics[height=4in]{modulated_random_dataset_fft.png}
    \caption{$S_M(f)$ for large (random) data set}
    \label{fig:S_M(f)}
  \end{figure}

\subsection{Receiver}
\begin{enumerate}
\item Time domain graphs of signals: outputs of transmit filters in Figure \ref{fig:s_d(t)}; outputs of matched filters in receiver in Figure \ref{fig:q(t)}. The transmit filter simply outputs a constant function of the symbol because we use a full-response pulse ($g(t) = 1\ \forall t \in Ts\ ,\ 0\ \text{otherwise}$). The matched filter produces an integral of the demodulated signal re-starting from 0 at every symbol interval. We can see that the peak of the integral corresponds to the end of the symbol interval, and is equal to the value of the symbol that was transmitted.

  \begin{figure}[h!]
    \centering
    \includegraphics[height=4in]{transmit_filter_output.png}
    \caption{$s_{d_i}(t)$ and $s_{d_q}(t)$, outputs of the transmit filter (before modulation)}
    \label{fig:s_d(t)}
  \end{figure}

  \begin{figure}[h!]
    \centering
    \includegraphics[height=4in]{matched_filter_output.png}
    \caption{$q_i(t)$ and $q_q(t)$, sampled outputs of the matched filters (before decision device)}
    \label{fig:q(t)}
  \end{figure}

\item Symbols: for constant phase - ideal synchronization between transmitter and receiver. Table \ref{tab:recvsymbols} shows the values of the symbols received from the matched filter (after sampling). Figure \ref{fig:recv_constellation} shows the received symbols as a constellation. A comparison of the transmitted symbols with the received ones shows that they are quite close, as can be seen in Figure \ref{fig:zoom_constellation}. The errors (difference) between distances of transmitted symbols to those received are shown in Table \ref{tab:dist_recvsymbols}. The errors are small, and are due to the inprecise integration method ('trapz' Matlab function, trapezoid integration) used in the simulation. In an ideal system there would be no error in this case. Mathematically, the distances are 0.


  \begin{center}
    \begin{table}[h]
      \centering
      \begin{tabular}[h]{| l | l |}
      \hline
      k             &  Received Symbol  \\ \hline
      1             &  0.7035 + 0.7053j \\ \hline
      2             & -0.7035 - 0.7053j \\ \hline
      3             &  0.7053 - 0.7071j \\ \hline
      4             & -0.7053 + 0.7071j \\
      \hline
      \end{tabular}
      \caption{Symbols received (sampled matched filter output)}
      \label{tab:recvsymbols}
    \end{table}
  \end{center}

  \begin{figure}[h]
    \centering
    \includegraphics[height=4in]{recv_symbol_constellation.png}
    \caption{Constellation of symbols received}
    \label{fig:recv_constellation}
  \end{figure}

  \begin{center}
    \begin{table}[h]
      \centering
      \begin{tabular}[h]{| l | l |}
      \hline
      Symbol    &  Distance \\ \hline
      $A_{r_1}$  &     0.0040 \\ \hline
      $A_{r_2}$  &     0.0018 \\ \hline
      $A_{r_3}$  &     0.0040 \\ \hline
      $A_{r_4}$  &     0.0018 \\ 
      \hline
      \end{tabular}
      \caption{Distances between symbols transmitted and those received}
      \label{tab:dist_recvsymbols}
    \end{table}
  \end{center}

  \begin{figure}[h]
    \centering
    \includegraphics[height=4in]{trans_recv_constellation_zoom.png}
    \caption{Zoom on the first symbol $A_1$ - showing the transmitted and received symbols. \newline The dotted line represents a portion of the unit circle.}
    \label{fig:zoom_constellation}
  \end{figure}



\item Symbols: unsychronized phase channel - difference of $30^o$ between transmitted and received. Table \ref{tab:recvsymbols_phase} shows the values of the symbols received from the matched filter (after sampling). Figure \ref{fig:recv_constellation_phase} shows the received symbols as a constellation. A comparison of the transmitted symbols with the received ones shows that they are quite close, as can be seen in Figure \ref{fig:trans_recv_constellation_phase}. The distances between transmitted symbols to those received are shown in Table \ref{tab:dist_recvsymbols_phase}. The large errors are due to the phase difference between transmitter and receiver.


  \begin{center}
    \begin{table}[h]
      \centering
      \begin{tabular}[h]{| l | l |}
      \hline
      k             &  Received Symbol  \\ \hline
      1             &  0.7035 + 0.7053j \\ \hline
      2             & -0.7035 - 0.7053j \\ \hline
      3             &  0.7053 - 0.7071j \\ \hline
      4             & -0.7053 + 0.7071j \\
      \hline
      \end{tabular}
      \caption{Symbols received with phase difference of $pi/6$ (sampled matched filter output)}
      \label{tab:recvsymbols_phase}
    \end{table}
  \end{center}

  \begin{figure}[h]
    \centering
    \includegraphics[height=4in]{recv_symbol_constellation_phase.png}
    \caption{Constellation of symbols received with phase difference of $pi/6$}
    \label{fig:recv_constellation_phase}
  \end{figure}



  \begin{center}
    \begin{table}[h]
      \centering
      \begin{tabular}[h]{| l | l |}
      \hline
      Symbol    &  Distance \\ \hline
      $A_{r_1}$  &  0.5155   \\ \hline
      $A_{r_2}$  &  0.5185   \\ \hline
      $A_{r_3}$  &  0.5155   \\ \hline
      $A_{r_4}$  &  0.5185   \\ 
      \hline
      \end{tabular}
      \caption{Distances between symbols transmitted and those received with phase difference of $pi/6$}
      \label{tab:dist_recvsymbols_phase}
    \end{table}
  \end{center}

  \begin{figure}[h]
    \centering
    \includegraphics[height=4in]{trans_recv_constellation_phase.png}
    \caption{Constellation of the transmitted and received symbols with phase difference of $pi/6$. \newline The dotted line represents the unit circle.}
    \label{fig:trans_recv_constellation_phase}
  \end{figure}




\end{enumerate}


\end{document}

